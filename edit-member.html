<a href="edit-member.html?id=abc123"><button>‚úèÔ∏è</button></a>

<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <link href="style.css" rel="stylesheet">
</head>
<body>

  <header style="text-align: center; background-color: #ffe0b2; padding: 20px;">
    <h2>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
    <p>‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
  </header>

  <form id="editForm" style="max-width: 600px; margin: auto; padding: 20px; background-color: #fff8e1; border-radius: 8px;">
    <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label><br>
    <input type="text" name="fullname" required style="width: 100%;"><br><br>

    <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô:</label><br>
    <input type="text" name="idcard" maxlength="13" required style="width: 100%;"><br><br>

    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label><br>
    <input type="tel" name="phone" required style="width: 100%;"><br><br>

    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</label><br>
    <textarea name="address" rows="3" required style="width: 100%;"></textarea><br><br>

    <label>‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô:</label><br>
    <select name="village" required style="width: 100%;">
      <option value="‡∏ö‡πâ‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏ò‡∏á">‡∏ö‡πâ‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏ò‡∏á</option>
      <option value="‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏•‡πà‡∏°">‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏•‡πà‡∏°</option>
      <option value="‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ö‡∏™‡∏≤">‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ö‡∏™‡∏≤</option>
    </select><br><br>

    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏ô:</label><br>
    <input type="number" name="members" min="1" required style="width: 100%;"><br><br>

    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡πâ‡∏≤‡∏ô:</label><br>
    <select name="houseType" required style="width: 100%;">
      <option value="‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢">‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢</option>
      <option value="‡∏´‡∏≠‡∏û‡∏±‡∏Å/‡∏≠‡∏û‡∏≤‡∏£‡πå‡∏ï‡πÄ‡∏°‡∏ô‡∏ï‡πå">‡∏´‡∏≠‡∏û‡∏±‡∏Å/‡∏≠‡∏û‡∏≤‡∏£‡πå‡∏ï‡πÄ‡∏°‡∏ô‡∏ï‡πå</option>
      <option value="‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
    </select><br><br>

    <label>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô LINE OA:</label><br>
    <select name="lineSubscribe" required style="width: 100%;">
      <option value="yes">‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</option>
      <option value="no">‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</option>
    </select><br><br>

    <div style="text-align: center;">
      <button type="submit">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
    </div>
  </form>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
    auth.onAuthStateChanged(user => {
      if (!user) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ");
        window.location.href = "login.html";
      }
    });

    // ‡∏£‡∏±‡∏ö ID ‡∏à‡∏≤‡∏Å URL
    const urlParams = new URLSearchParams(window.location.search);
    const memberId = urlParams.get("id");

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
    db.collection("members").doc(memberId).get().then(doc => {
      if (!doc.exists) {
        alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å");
        return;
      }
      const data = doc.data();
      for (const key in data) {
        const field = document.querySelector(`[name='${key}']`);
        if (field) field.value = data[key];
      }
    });

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
    document.getElementById("editForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const updatedData = {
        fullname: this.fullname.value,
        idcard: this.idcard.value,
        phone: this.phone.value,
        address: this.address.value,
        village: this.village.value,
        members: this.members.value,
        houseType: this.houseType.value,
        lineSubscribe: this.lineSubscribe.value
      };
      await db.collection("members").doc(memberId).update(updatedData);
      alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
      window.location.href = "members-list.html";
    });
  </script>

</body>
</html>
